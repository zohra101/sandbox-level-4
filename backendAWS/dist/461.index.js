/*! For license information please see 461.index.js.LICENSE.txt */
"use strict";exports.id=461,exports.ids=[461],exports.modules={1461:(t,r,e)=>{e.r(r),e.d(r,{DEFAULT_MAX_RETRIES:()=>b,DEFAULT_TIMEOUT:()=>m,ENV_CMDS_AUTH_TOKEN:()=>A,ENV_CMDS_FULL_URI:()=>T,ENV_CMDS_RELATIVE_URI:()=>I,Endpoint:()=>K,fromContainerMetadata:()=>D,fromInstanceMetadata:()=>Ot,getInstanceMetadataEndpoint:()=>X,httpRequest:()=>h,providerConfigFromInit:()=>w});var n=e(5746),o=e(7016),i=e(1352),a=e(181),u=e(8611);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?s(Object(e),!0).forEach((function(r){l(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):s(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function l(t,r,e){return(r=function(t){var r=function(t){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=c(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function h(t){return new Promise((function(r,e){var n,o=(0,u.request)(f(f({method:"GET"},t),{},{hostname:null===(n=t.hostname)||void 0===n?void 0:n.replace(/^\[(.+)\]$/,"$1")}));o.on("error",(function(t){e(Object.assign(new i.m("Unable to connect to instance metadata service"),t)),o.destroy()})),o.on("timeout",(function(){e(new i.m("TimeoutError from instance metadata service")),o.destroy()})),o.on("response",(function(t){var n=t.statusCode,u=void 0===n?400:n;(u<200||300<=u)&&(e(Object.assign(new i.m("Error response received from instance metadata service"),{statusCode:u})),o.destroy());var c=[];t.on("data",(function(t){c.push(t)})),t.on("end",(function(){r(a.Buffer.concat(c)),o.destroy()}))})),o.end()}))}function p(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function y(t,r,e){return(r=function(t){var r=function(t){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=v(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}var d=function(t){return Boolean(t)&&"object"===v(t)&&"string"==typeof t.AccessKeyId&&"string"==typeof t.SecretAccessKey&&"string"==typeof t.Token&&"string"==typeof t.Expiration},g=function(t){return function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?p(Object(e),!0).forEach((function(r){y(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}({accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,sessionToken:t.Token,expiration:new Date(t.Expiration)},t.AccountId&&{accountId:t.AccountId})},m=1e3,b=0,w=function(t){var r=t.maxRetries,e=void 0===r?b:r,n=t.timeout;return{maxRetries:e,timeout:void 0===n?m:n}},O=function(t,r){for(var e=t(),n=0;n<r;n++)e=e.catch(t);return e};function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function E(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function j(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?E(Object(e),!0).forEach((function(r){S(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):E(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function S(t,r,e){return(r=function(t){var r=function(t){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=x(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function _(){_=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var l={};function h(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(P([])));g&&g!==e&&n.call(g,i)&&(v=g);var m=y.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function w(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==x(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function O(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,O(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,l):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){this.tryEntries.push(t)}function j(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function P(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(x(r)+" is not iterable")}return p.prototype=y,c(m,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),r.AsyncIterator=w,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=P,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],l):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),l},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),j(e),l}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;j(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:P(r),r:e,n},"next"===this.method&&(this.arg=t),l}},r}function P(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function k(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){P(i,n,o,a,u,"next",t)}function u(t){P(i,n,o,a,u,"throw",t)}a(void 0)}))}}var T="AWS_CONTAINER_CREDENTIALS_FULL_URI",I="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",A="AWS_CONTAINER_AUTHORIZATION_TOKEN",D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=w(t),e=r.timeout,o=r.maxRetries;return function(){return O(k(_().mark((function r(){var o,i;return _().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,F({logger:t.logger});case 2:return o=r.sent,r.t0=JSON,r.next=6,N(e,o);case 6:if(r.t1=r.sent,i=r.t0.parse.call(r.t0,r.t1),d(i)){r.next=10;break}throw new n.C("Invalid response received from instance metadata service.",{logger:t.logger});case 10:return r.abrupt("return",g(i));case 11:case"end":return r.stop()}}),r)}))),o)}},N=function(){var t=k(_().mark((function t(r,e){var n;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return process.env[A]&&(e.headers=j(j({},e.headers),{},{Authorization:process.env[A]})),t.next=3,h(j(j({},e),{},{timeout:r}));case 3:return n=t.sent,t.abrupt("return",n.toString());case 5:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}(),G={localhost:!0,"127.0.0.1":!0},C={"http:":!0,"https:":!0},F=function(){var t=k(_().mark((function t(r){var e,i;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.logger,!process.env[I]){t.next=3;break}return t.abrupt("return",{hostname:"169.254.170.2",path:process.env[I]});case 3:if(!process.env[T]){t.next=10;break}if((i=(0,o.parse)(process.env[T])).hostname&&i.hostname in G){t.next=7;break}throw new n.C("".concat(i.hostname," is not a valid container metadata service hostname"),{tryNextLink:!1,logger:e});case 7:if(i.protocol&&i.protocol in C){t.next=9;break}throw new n.C("".concat(i.protocol," is not a valid container metadata service protocol"),{tryNextLink:!1,logger:e});case 9:return t.abrupt("return",j(j({},i),{},{port:i.port?parseInt(i.port,10):void 0}));case 10:throw new n.C("The container metadata credential provider cannot be used unless"+" the ".concat(I," or ").concat(T," environment")+" variable is set",{tryNextLink:!1,logger:e});case 11:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}(),R=e(6488);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function L(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(L=function(){return!!t})()}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}function U(t,r){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},U(t,r)}var K,W=function(t){function r(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,r),(e=function(t,r,e){return r=V(r),function(t,r){if(r&&("object"==M(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,L()?Reflect.construct(r,e||[],V(t).constructor):r.apply(t,e))}(this,r,[t,n])).tryNextLink=n,e.name="InstanceMetadataV1FallbackError",Object.setPrototypeOf(e,r.prototype),e}return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&U(t,r)}(r,t),e=r,Object.defineProperty(e,"prototype",{writable:!1}),e;var e}(n.C),B=e(3863);!function(t){t.IPv4="http://169.254.169.254",t.IPv6="http://[fd00:ec2::254]"}(K||(K={}));var Y,Z={environmentVariableSelector:function(t){return t.AWS_EC2_METADATA_SERVICE_ENDPOINT},configFileSelector:function(t){return t.ec2_metadata_service_endpoint},default:void 0};!function(t){t.IPv4="IPv4",t.IPv6="IPv6"}(Y||(Y={}));var q={environmentVariableSelector:function(t){return t.AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE},configFileSelector:function(t){return t.ec2_metadata_service_endpoint_mode},default:Y.IPv4};function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function H(){H=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var l={};function h(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==e&&n.call(g,i)&&(v=g);var m=y.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function w(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==z(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function O(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,O(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,l):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(z(r)+" is not iterable")}return p.prototype=y,c(m,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),r.AsyncIterator=w,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=S,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],l):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),l},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),l}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:S(r),r:e,n},"next"===this.method&&(this.arg=t),l}},r}function J(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function $(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){J(i,n,o,a,u,"next",t)}function u(t){J(i,n,o,a,u,"throw",t)}a(void 0)}))}}var X=function(){var t=$(H().mark((function t(){return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=B.D,t.next=3,Q();case 3:if(t.t1=t.sent,t.t1){t.next=8;break}return t.next=7,tt();case 7:t.t1=t.sent;case 8:return t.t2=t.t1,t.abrupt("return",(0,t.t0)(t.t2));case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Q=function(){var t=$(H().mark((function t(){return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,R.Z)(Z)());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),tt=function(){var t=$(H().mark((function t(){var r;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,R.Z)(q)();case 2:r=t.sent,t.t0=r,t.next=t.t0===Y.IPv4?6:t.t0===Y.IPv6?7:8;break;case 6:return t.abrupt("return",K.IPv4);case 7:return t.abrupt("return",K.IPv6);case 8:throw new Error("Unsupported endpoint mode: ".concat(r,".")+" Select from ".concat(Object.values(Y)));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function et(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function nt(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?et(Object(e),!0).forEach((function(r){ot(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):et(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function ot(t,r,e){return(r=function(t){var r=function(t){if("object"!=rt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=rt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var it=function(t,r){var e,n=300+Math.floor(300*Math.random()),o=new Date(Date.now()+1e3*n);r.warn("Attempting credential expiration extension due to a credential service availability issue. A refresh of these "+"credentials will be attempted after ".concat(new Date(o),".\nFor more information, please visit: ")+"https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html");var i=null!==(e=t.originalExpiration)&&void 0!==e?e:t.expiration;return nt(nt(nt({},t),i?{originalExpiration:i}:{}),{},{expiration:o})};function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ut(){ut=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var l={};function h(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==e&&n.call(g,i)&&(v=g);var m=y.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function w(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==at(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function O(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,O(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,l):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(at(r)+" is not iterable")}return p.prototype=y,c(m,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),r.AsyncIterator=w,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=S,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],l):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),l},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),l}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:S(r),r:e,n},"next"===this.method&&(this.arg=t),l}},r}function ct(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function st(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){ct(i,n,o,a,u,"next",t)}function u(t){ct(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function lt(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function ht(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?lt(Object(e),!0).forEach((function(r){pt(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):lt(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function pt(t,r,e){return(r=function(t){var r=function(t){if("object"!=ft(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=ft(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function yt(){yt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var l={};function h(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==e&&n.call(g,i)&&(v=g);var m=y.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function w(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==ft(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function O(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,O(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,l):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(ft(r)+" is not iterable")}return p.prototype=y,c(m,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),r.AsyncIterator=w,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=S,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],l):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),l},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),l}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:S(r),r:e,n},"next"===this.method&&(this.arg=t),l}},r}function vt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function dt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){vt(i,n,o,a,u,"next",t)}function u(t){vt(i,n,o,a,u,"throw",t)}a(void 0)}))}}var gt="/latest/meta-data/iam/security-credentials/",mt="AWS_EC2_METADATA_V1_DISABLED",bt="ec2_metadata_v1_disabled",wt="x-aws-ec2-metadata-token",Ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(null==e?void 0:e.logger)||console;return st(ut().mark((function e(){var o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:(o=e.sent).expiration&&o.expiration.getTime()<Date.now()&&(o=it(o,n)),e.next=15;break;case 7:if(e.prev=7,e.t0=e.catch(0),!r){e.next=14;break}n.warn("Credential renew failed: ",e.t0),o=it(r,n),e.next=15;break;case 14:throw e.t0;case 15:return r=o,e.abrupt("return",o);case 17:case"end":return e.stop()}}),e,null,[[0,7]])})))}(xt(t),{logger:t.logger})},xt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!1,e=t.logger,o=t.profile,i=w(t),a=i.timeout,u=i.maxRetries,c=function(){var e=dt(yt().mark((function e(i,a){var u,c,s,f,l,h;return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r&&null!=(null===(u=a.headers)||void 0===u?void 0:u[wt])){e.next=13;break}return c=!1,s=!1,e.next=6,(0,R.Z)({environmentVariableSelector:function(r){var e=r[mt];if(s=!!e&&"false"!==e,void 0===e)throw new n.C("".concat(mt," not set in env, checking config file next."),{logger:t.logger});return s},configFileSelector:function(t){var r=t[bt];return c=!!r&&"false"!==r},default:!1},{profile:o})();case 6:if(f=e.sent,!t.ec2MetadataV1Disabled&&!f){e.next=13;break}throw l=[],t.ec2MetadataV1Disabled&&l.push("credential provider initialization (runtime option ec2MetadataV1Disabled)"),c&&l.push("config file profile (".concat(bt,")")),s&&l.push("process environment variable (".concat(mt,")")),new W("AWS EC2 Metadata v1 fallback has been blocked by AWS SDK configuration in the following: [".concat(l.join(", "),"]."));case 13:return e.next=15,O(dt(yt().mark((function t(){var e;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,jt(a);case 3:e=t.sent,t.next=10;break;case 6:throw t.prev=6,t.t0=t.catch(0),401===t.t0.statusCode&&(r=!1),t.t0;case 10:return t.abrupt("return",e);case 11:case"end":return t.stop()}}),t,null,[[0,6]])}))),i);case 15:return h=e.sent.trim(),e.abrupt("return",O(dt(yt().mark((function e(){var n;return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,St(h,a,t);case 3:n=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),401===e.t0.statusCode&&(r=!1),e.t0;case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,null,[[0,6]])}))),i));case 17:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return dt(yt().mark((function t(){var n,o;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X();case 2:if(n=t.sent,!r){t.next=8;break}return null==e||e.debug("AWS SDK Instance Metadata","using v1 fallback (no token fetch)"),t.abrupt("return",c(u,ht(ht({},n),{},{timeout:a})));case 8:return t.prev=8,t.next=11,Et(ht(ht({},n),{},{timeout:a}));case 11:o=t.sent.toString(),t.next=23;break;case 14:if(t.prev=14,t.t0=t.catch(8),400!==(null===t.t0||void 0===t.t0?void 0:t.t0.statusCode)){t.next=20;break}throw Object.assign(t.t0,{message:"EC2 Metadata token request returned error"});case 20:("TimeoutError"===t.t0.message||[403,404,405].includes(t.t0.statusCode))&&(r=!0);case 21:return null==e||e.debug("AWS SDK Instance Metadata","using v1 fallback (initial)"),t.abrupt("return",c(u,ht(ht({},n),{},{timeout:a})));case 23:return t.abrupt("return",c(u,ht(ht({},n),{},{headers:pt({},wt,o),timeout:a})));case 24:case"end":return t.stop()}}),t,null,[[8,14]])})))},Et=function(){var t=dt(yt().mark((function t(r){return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",h(ht(ht({},r),{},{path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}})));case 1:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}(),jt=function(){var t=dt(yt().mark((function t(r){return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(ht(ht({},r),{},{path:gt}));case 2:return t.abrupt("return",t.sent.toString());case 3:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}(),St=function(){var t=dt(yt().mark((function t(r,e,o){var i;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,h(ht(ht({},e),{},{path:gt+r}));case 3:if(t.t1=t.sent.toString(),i=t.t0.parse.call(t.t0,t.t1),d(i)){t.next=7;break}throw new n.C("Invalid response received from instance metadata service.",{logger:o.logger});case 7:return t.abrupt("return",g(i));case 8:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}()}};
//# sourceMappingURL=461.index.js.map